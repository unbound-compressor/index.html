<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unbound Compressor</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #9b4dca; --bg: #f4f4f9; }
        body { font-family: 'Poppins', sans-serif; background: var(--bg); margin: 0; display: flex; flex-direction: column; align-items: center; }
        
        .navbar { background: white; width: 100%; padding: 15px 0; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); color: var(--primary); font-weight: 600; font-size: 20px; }
        
        .container { background: white; width: 90%; max-width: 450px; margin-top: 30px; padding: 25px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.05); text-align: center; }

        /* ‡§Ö‡§™‡§≤‡•ã‡§° ‡§¨‡•â‡§ï‡•ç‡§∏ ‡§î‡§∞ ‡§´‡•ã‡§ü‡•ã ‡§™‡•ç‡§∞‡•Ä‡§µ‡•ç‡§Ø‡•Ç */
        .upload-area { border: 2px dashed #ddd; border-radius: 12px; padding: 20px; cursor: pointer; transition: 0.3s; position: relative; overflow: hidden; min-height: 100px; display: flex; align-items: center; justify-content: center; flex-direction: column; }
        .upload-area:hover { border-color: var(--primary); background: #fdf8ff; }
        
        #preview { max-width: 100px; max-height: 100px; border-radius: 8px; display: none; margin-bottom: 10px; animation: popIn 0.3s ease; }
        @keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        .input-group { margin: 25px 0; display: flex; justify-content: center; gap: 10px; align-items: center; }
        input[type="number"] { width: 60px; padding: 8px; border: 1px solid #ddd; border-radius: 6px; }
        select { padding: 8px; border-radius: 6px; border: 1px solid #ddd; }

        /* ‡§¨‡§ü‡§® ‡§è‡§®‡•Ä‡§Æ‡•á‡§∂‡§® */
        .btn-compress { background: var(--primary); color: white; border: none; padding: 14px; border-radius: 10px; width: 100%; font-size: 16px; font-weight: 600; cursor: pointer; transition: 0.2s; }
        .btn-compress:active { transform: scale(0.96); } 

        .success-msg { color: #27ae60; background: #eafaf1; padding: 10px; border-radius: 8px; margin-top: 15px; display: none; font-size: 14px; animation: slideUp 0.4s ease; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .btn-download { background: #333; color: white; border: none; padding: 12px; border-radius: 10px; width: 100%; margin-top: 10px; display: none; cursor: pointer; }
        
        .footer { margin-top: 30px; color: #888; font-size: 13px; }
    </style>
</head>
<body>

<div class="navbar">üü£ Unbound Compressor</div>

<div class="container">
    <div class="upload-area" onclick="document.getElementById('fileInput').click()">
        <img id="preview">
        <span id="fileName" style="font-size: 14px; color: #666;">‡§´‡•ã‡§ü‡•ã ‡§ö‡•Å‡§®‡•á‡§Ç (Max 100KB)</span>
        <input type="file" id="fileInput" hidden accept="image/*">
    </div>

    <div class="input-group">
        <span>‡§∏‡§æ‡§á‡§ú:</span>
        <input type="number" id="targetSize" value="20">
        <select id="unit"><option value="kb">KB</option></select>
    </div>

    <button class="btn-compress" onclick="compressImage()">Compress Now</button>

    <div id="status" class="success-msg"></div>
    <button id="downloadBtn" class="btn-download">Download Image</button>
</div>

<div class="footer">‡§¨‡§®‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à <b>‡§∂‡§ø‡§µ‡§Æ</b> ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ | <b>Unbound Safar</b></div>

<script>
    const fileInput = document.getElementById('fileInput');
    const preview = document.getElementById('preview');
    const fileName = document.getElementById('fileName');
    const status = document.getElementById('status');
    const downloadBtn = document.getElementById('downloadBtn');
    let originalImage = null;

    fileInput.onchange = (e) => {
        const file = e.target.files[0];
        if (file) {
            fileName.innerText = file.name;
            const reader = new FileReader();
            reader.onload = (event) => {
                originalImage = new Image();
                originalImage.src = event.target.result;
                originalImage.onload = () => {
                    preview.src = originalImage.src;
                    preview.style.display = 'block';
                }
            };
            reader.readAsDataURL(file);
        }
    };

    async function compressImage() {
        if (!originalImage) { alert("‡§´‡•ã‡§ü‡•ã ‡§ö‡•Å‡§®‡•á‡§Ç!"); return; }
        const targetKB = document.getElementById('targetSize').value;
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = originalImage.width;
        canvas.height = originalImage.height;
        ctx.drawImage(originalImage, 0, 0, canvas.width, canvas.height);

        let quality = 0.9;
        let blob;
        for (let i = 0; i < 8; i++) {
            blob = await new Promise(r => canvas.toBlob(r, 'image/jpeg', quality));
            if (blob.size / 1024 <= targetKB || quality <= 0.1) break;
            quality -= 0.15;
        }

        const url = URL.createObjectURL(blob);
        status.innerText = `Success! Size: ${(blob.size / 1024).toFixed(2)} KB`;
        status.style.display = 'block';
        downloadBtn.style.display = 'block';
        downloadBtn.onclick = () => {
            const a = document.createElement('a');
            a.href = url;
            a.download = `unbound_${fileInput.files[0].name}`;
            a.click();
        };
    }
</script>

</body>
</html>
